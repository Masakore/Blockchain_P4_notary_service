# Blockchain_P4_notary_service
Star Registry service that allows users to claim ownership of their favorite star in the night sky.
This app runs on Express.js

## Usage
1. Run command -> $npm install
2. Run command -> $node index.js

## API
* [<code><b>Get <hostname>/block/:height</b></code>](#get_by_height)
* [<code><b>Get <hostname>/stars/address/:address</b></code>](#get_by_address)
* [<code><b>Get <hostname>/stars/hash/:hash</b></code>](#get_by_hash)
* [<code><b>Post <hostname>/block/</b></code>](#post_block)
* [<code><b>Post <hostname>/requestValidation/</b></code>](#post_request_validation)
* [<code><b>Post <hostname>/message-signature/validate</b></code>](#post_signature_validation)

<a name="get_height"></a>
### `GET <hostname>/block/:height`

Call this endpoint with block height and will return a result in JSON format like below.

```
Sample result:

{
  "hash": "a59e9e399bc17c2db32a7a87379a8012f2c8e08dd661d7c0a6a4845d4f3ffb9f",
  "height": 1,
  "body": {
    "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
    "star": {
      "ra": "16h 29m 1.0s",
      "dec": "-26° 29' 24.9",
      "story": "466f756e642073746172207573696e672068747470733a2f2f7777772e676f6f676c652e636f6d2f736b792f",
      "storyDecoded": "Found star using https://www.google.com/sky/"
    }
  },
  "time": "1532296234",
  "previousBlockHash": "49cce61ec3e6ae664514d5fa5722d86069cf981318fc303750ce66032d0acff3"
}
```

<a name="get_by_address"></a>
### `GET <hostname>/stars/address/:address`

Call this endpoint with your wallet address and will return a result in JSON format like below.

```
Sample result:

[
  {
    "hash": "a59e9e399bc17c2db32a7a87379a8012f2c8e08dd661d7c0a6a4845d4f3ffb9f",
    "height": 1,
    "body": {
      "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
      "star": {
        "ra": "16h 29m 1.0s",
        "dec": "-26° 29' 24.9",
        "story": "466f756e642073746172207573696e672068747470733a2f2f7777772e676f6f676c652e636f6d2f736b792f",
        "storyDecoded": "Found star using https://www.google.com/sky/"
      }
    },
    "time": "1532296234",
    "previousBlockHash": "49cce61ec3e6ae664514d5fa5722d86069cf981318fc303750ce66032d0acff3"
  },
  {
    "hash": "6ef99fc533b9725bf194c18bdf79065d64a971fa41b25f098ff4dff29ee531d0",
    "height": 2,
    "body": {
      "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
      "star": {
        "ra": "17h 22m 13.1s",
        "dec": "-27° 14' 8.2",
        "story": "466f756e642073746172207573696e672068747470733a2f2f7777772e676f6f676c652e636f6d2f736b792f",
        "storyDecoded": "Found star using https://www.google.com/sky/"
      }
    },
    "time": "1532330848",
    "previousBlockHash": "a59e9e399bc17c2db32a7a87379a8012f2c8e08dd661d7c0a6a4845d4f3ffb9f"
  }
]
```

<a name="get_by_hash"></a>
### `GET <hostname>/stars/hash/:hash`

Call this endpoint with block hash and will return a result in JSON format like below.

```
Sample result:

{
  "hash": "a59e9e399bc17c2db32a7a87379a8012f2c8e08dd661d7c0a6a4845d4f3ffb9f",
  "height": 1,
  "body": {
    "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
    "star": {
      "ra": "16h 29m 1.0s",
      "dec": "-26° 29' 24.9",
      "story": "466f756e642073746172207573696e672068747470733a2f2f7777772e676f6f676c652e636f6d2f736b792f",
      "storyDecoded": "Found star using https://www.google.com/sky/"
    }
  },
  "time": "1532296234",
  "previousBlockHash": "49cce61ec3e6ae664514d5fa5722d86069cf981318fc303750ce66032d0acff3"
}
```


<a name="post_block"></a>
### `POST <hostname>/block/`

Call this endpoint with http body in json format which contain the data you would like to add to this blockchain. And then, you would see the stored block in JSON format like below.

```
Sample http body for request:
Content-Type: application/json

{
  "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
  "star": {
    "dec": "-26° 29'\'' 24.9",
    "ra": "16h 29m 1.0s",
    "story": "Found star using https://www.google.com/sky/"
}
```

```
Sample result:

{
  "hash": "a59e9e399bc17c2db32a7a87379a8012f2c8e08dd661d7c0a6a4845d4f3ffb9f",
  "height": 1,
  "body": {
    "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
    "star": {
      "ra": "16h 29m 1.0s",
      "dec": "-26° 29' 24.9",
      "story": "466f756e642073746172207573696e672068747470733a2f2f7777772e676f6f676c652e636f6d2f736b792f"
    }
  },
  "time": "1532296234",
  "previousBlockHash": "49cce61ec3e6ae664514d5fa5722d86069cf981318fc303750ce66032d0acff3"
}
```

<a name="post_request_validation"></a>
### `POST <hostname>/requestValidation/`

Let users submit their request using their wallet address. After submitting a request, the user will receive a response in JSON format with a message to sign.
This API will accept a Blockchain ID (The Blockchain ID is your wallet address with a request for star registration.
The user's Blockchain ID will be stored with a timestamp.
This timestamp must be used to prove the user request for star registration.
In the event the time expires, the address is removed from the validation routine forcing the user to restart the process.

```
Sample http body for request:
Content-Type: application/json

{
  "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
}
```

```
Sample result:

{
  "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
  "requestTimeStamp": "1532296090",
  "message": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ:1532296090:starRegistry",
  "validationWindow": 300
}
```

<a name="post_signature_validation"></a>
### `POST <hostname>/message-signature/validate`

After receiving the response through requestValidation API, users will prove their blockchain identity by signing a message with their wallet. Once they sign this message, the application will validate their request and grant access to register a star.

```
Sample http body:
Content-Type: application/json

{
  "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
  "signature": "H6ZrGrF0Y4rMGBMRT2+hHWGbThTIyhBS0dNKQRov9Yg6GgXcHxtO9GJN4nwD2yNXpnXHTWU9i+qdw5vpsooryLU="

}
```

```
Sample result:
Content-Type: application/json

{
  "registerStar": true,
  "status": {
    "address": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ",
    "requestTimeStamp": "1532296090",
    "message": "142BDCeSGbXjWKaAnYXbMpZ6sbrSAo3DpZ:1532296090:starRegistry",
    "validationWindow": 193,
    "messageSignature": "valid"
  }
}
```
